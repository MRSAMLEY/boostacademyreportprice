<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Boost Academy Customer Report</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
    body { font-family: 'Inter', sans-serif; }

    .rgb-border-wrap {
        position: relative;
        z-index: 10;
        padding: 1px;
        background: #111827;
        border-radius: 1.5rem;
        overflow: hidden;
        box-shadow: 0 10px 15px -3px rgba(0,0,0,0.5),0 4px 6px -2 rgba(0,0,0,0.05);
    }
    .rgb-border-wrap::before {
        content: '';
        position: absolute;
        top: -50%; left: -50%;
        width: 200%; height: 200%;
        background: conic-gradient(#ff0000,#ffff00,#00ff00,#00ffff,#0000ff,#ff00ff,#ff0000);
        z-index: -1;
        animation: rotate 4s linear infinite;
    }
    @keyframes rotate { 0%{transform:rotate(0deg);}100%{transform:rotate(360deg);} }

    .rgb-inner-content {
        background-color: #111827;
        border-radius: 1.5rem;
        padding: 2.5rem 1.5rem;
    }

    input:focus, select:focus {
        border-color: #06b6d4 !important;
        box-shadow: 0 0 0 2px #06b6d4 !important;
    }
    input, select {
        background-color: #1f2937 !important;
        border-color: #374151 !important;
        color: #f3f4f6 !important;
    }

    .file-drop-area {
        border: 2px dashed #06b6d4;
        border-radius: 1rem;
        padding: 2rem;
        text-align: center;
        cursor: pointer;
        transition: background-color 0.2s;
    }
    .file-drop-area.dragover {
        background-color: rgba(6,182,212,0.1);
    }
</style>
</head>
<body class="bg-gray-900 antialiased text-gray-100 min-h-screen flex items-center justify-center p-4 sm:p-6">

<div class="rgb-border-wrap w-full max-w-xl transition-all duration-300 rounded-3xl">
    <div class="rgb-inner-content w-full">

        <header class="text-center mb-10">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-cyan-400 mb-2 tracking-wider">Boost Academy Report</h1>
            <p class="text-gray-400 font-mono text-sm">Secure Data Submission // Protocol Online</p>
        </header>

        <form id="report-form" onsubmit="event.preventDefault(); sendReport();" class="space-y-6">

            <div class="space-y-4">
                <input type="text" id="name" placeholder="Customer Name" required
                    class="w-full p-3 border rounded-lg focus:ring-1 focus:ring-cyan-500 transition duration-150 border-gray-700 bg-gray-800 text-gray-100" />
                <input type="tel" id="number" placeholder="Customer Phone Number" required
                    class="w-full p-3 border rounded-lg focus:ring-1 focus:ring-cyan-500 transition duration-150 border-gray-700 bg-gray-800 text-gray-100" />
                <input type="text" id="address" placeholder="Delivery Address" required
                    class="w-full p-3 border rounded-lg focus:ring-1 focus:ring-cyan-500 transition duration-150 border-gray-700 bg-gray-800 text-gray-100" />
                <input type="text" id="delivery" placeholder="Delivery Express Service" required
                    class="w-full p-3 border rounded-lg focus:ring-1 focus:ring-cyan-500 transition duration-150 border-gray-700 bg-gray-800 text-gray-100" />
                <div class="relative">
                    <span class="absolute inset-y-0 left-0 flex items-center pl-3 text-cyan-500 font-bold">$</span>
                    <input type="number" id="price" placeholder="Price" step="0.01" required
                        class="w-full p-3 pl-8 border rounded-lg focus:ring-1 focus:ring-cyan-500 transition duration-150 border-gray-700 bg-gray-800 text-gray-100" />
                </div>
            </div>

            <label for="page-name" class="block text-cyan-400 font-semibold mb-2 mt-6">Origin Data Stream</label>
            <select id="page-name" required
                class="w-full p-3 border rounded-lg focus:ring-1 focus:ring-cyan-500 transition duration-150 mb-6 border-gray-700 bg-gray-800 text-gray-100">
                <option value="" disabled selected class="text-gray-400">Select Source Page</option>
                <option value="Bong Pheng Store">Bong Pheng Store</option>
                <option value="Mey Smile">Mey Smile</option>
                <option value="Page 3">Page 3</option>
                <option value="Page 4">Page 4</option>
            </select>

            <h2 class="text-lg font-semibold text-cyan-400 mb-3">Authorize Payment Channel</h2>
            <div id="bank-buttons" class="grid grid-cols-2 lg:grid-cols-4 gap-3 mb-6"></div>

            <!-- Drag & Drop Upload -->
            <label class="block text-cyan-400 font-semibold mb-2 mt-6">Upload Invoice</label>
            <div id="file-drop-area" class="file-drop-area mb-4">
                Drag & Drop Invoice Here or Click to Upload
                <input type="file" id="invoice-file" class="hidden" accept="image/*" />
            </div>
            <p id="file-name" class="text-gray-400 text-sm"></p>

            <button type="submit" id="submit-button"
                     class="w-full mt-8 bg-gradient-to-r from-cyan-600 to-teal-700 text-white font-bold text-xl py-4 rounded-xl shadow-lg hover:shadow-cyan-500/50 hover:from-cyan-700 hover:to-teal-800 transition duration-300 focus:outline-none focus:ring-4 focus:ring-cyan-500 focus:ring-opacity-50 flex justify-center items-center gap-2 tracking-wider">
                <span>Submit Report // Engage Protocol</span>
            </button>
        </form>
    </div>
</div>

<div id="message-modal" class="fixed inset-0 bg-gray-900 bg-opacity-90 hidden items-center justify-center p-4 z-50 transition-opacity duration-300 opacity-0" aria-modal="true" role="dialog">
    <div class="bg-gray-800 rounded-xl shadow-2xl max-w-sm w-full p-6 text-center transform scale-95 transition-transform duration-300 border-2 border-cyan-500">
        <div id="modal-icon" class="text-5xl mb-4"></div>
        <h3 id="modal-title" class="text-xl font-bold mb-2 text-cyan-400"></h3>
        <p id="modal-message" class="text-gray-300 mb-6 whitespace-pre-wrap"></p>
        <button onclick="hideModal()"
                class="bg-cyan-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-cyan-700 transition duration-150 w-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-cyan-500 focus:ring-offset-gray-800">
            Acknowledge // Close
        </button>
    </div>
</div>

<script>
const BOT_TOKEN = "8343485371:AAHUzwUW9flKScXHnLvpQO_wPjopAo9nOWc"; // Your Telegram Bot Token
const CHAT_ID = "-1003388800232"; // Your Telegram Chat ID

let selectedBank = null;
let selectedFile = null;

function showModal(title, message, type='info') {
    const modal = document.getElementById('message-modal');
    const modalTitle = document.getElementById('modal-title');
    const modalMessage = document.getElementById('modal-message');
    const modalIcon = document.getElementById('modal-icon');

    modalTitle.textContent = title;
    modalMessage.textContent = message;

    let iconHTML = '‚ÑπÔ∏è';
    if(type === 'success') iconHTML = '<span class="text-green-400">‚úÖ</span>';
    else if(type === 'error') iconHTML = '<span class="text-red-500">‚ùå</span>';
    else iconHTML = '<span class="text-cyan-400">üåê</span>';

    modalIcon.innerHTML = iconHTML;

    modal.classList.remove('hidden','opacity-0');
    modal.classList.add('flex','opacity-100');
    modal.querySelector('div').classList.remove('scale-95');
    modal.querySelector('div').classList.add('scale-100');
}

function hideModal() {
    const modal = document.getElementById('message-modal');
    modal.classList.add('opacity-0');
    modal.querySelector('div').classList.remove('scale-100');
    modal.querySelector('div').classList.add('scale-95');
    setTimeout(()=>{ modal.classList.add('hidden'); },300);
}

document.getElementById('message-modal').addEventListener('click', e => {
    if(e.target.id === 'message-modal') hideModal();
});

function setBank(bank) {
    selectedBank = bank;
    renderBankButtons();
}

function renderBankButtons() {
    const banks = ['ABA Bank','ACLEDA Bank','WING Bank','TRUE Money'];
    const container = document.getElementById('bank-buttons');
    container.innerHTML = '';
    banks.forEach(bank => {
        const button = document.createElement('button');
        button.type='button';
        button.textContent = bank;
        button.setAttribute('aria-pressed', selectedBank===bank);
        button.className = `
            w-full p-3 font-bold text-xs sm:text-sm rounded-xl transition duration-200 ease-in-out shadow-md
            ${selectedBank===bank ? 
                'bg-cyan-600 text-white shadow-cyan-500/50 ring-2 ring-cyan-500' : 
                'bg-gray-700 text-gray-300 hover:bg-cyan-900 hover:text-cyan-400 border border-gray-600'}
        `;
        button.onclick = ()=>setBank(bank);
        container.appendChild(button);
    });
}

document.addEventListener('DOMContentLoaded', renderBankButtons);

// File drag & drop
const dropArea = document.getElementById('file-drop-area');
const fileInput = document.getElementById('invoice-file');
const fileNameText = document.getElementById('file-name');

dropArea.addEventListener('click', () => fileInput.click());

fileInput.addEventListener('change', () => {
    if(fileInput.files.length) {
        selectedFile = fileInput.files[0];
        fileNameText.textContent = selectedFile.name;
    }
});

dropArea.addEventListener('dragover', e => {
    e.preventDefault();
    dropArea.classList.add('dragover');
});

dropArea.addEventListener('dragleave', e => {
    dropArea.classList.remove('dragover');
});

dropArea.addEventListener('drop', e => {
    e.preventDefault();
    dropArea.classList.remove('dragover');
    if(e.dataTransfer.files.length) {
        selectedFile = e.dataTransfer.files[0];
        fileInput.files = e.dataTransfer.files;
        fileNameText.textContent = selectedFile.name;
    }
});

function getInputValue(id) {
    const el = document.getElementById(id);
    return el ? el.value.trim() : '';
}

async function sendReport() {
    const name = getInputValue('name');
    const number = getInputValue('number');
    const address = getInputValue('address');
    const delivery = getInputValue('delivery');
    const price = getInputValue('price');
    const pageName = getInputValue('page-name');

    if(!pageName) { showModal('Error: Missing Data Stream','Select an Origin Data Stream.','error'); return; }
    if(!selectedBank) { showModal('Error: Missing Channel','Authorize a Payment Channel.','error'); return; }
    if(!name || !number || !address || !delivery || !price) { showModal('Error: Incomplete Matrix','All data fields must be populated.','error'); return; }
    if(!selectedFile) { showModal('Error: Missing Invoice','Upload an invoice image.','error'); return; }

    const phonePattern = /^\+?\d{8,15}$/;
    if(!phonePattern.test(number)) { showModal('Error: Invalid Node ID','Enter a valid phone number (Node ID).','error'); return; }

    if(parseFloat(price) <= 0) { showModal('Error: Invalid Value','Transaction Value must be greater than 0.','error'); return; }

    const caption = `
* Boost Academy Report Send *
[üü¢STATUS WEB BYüü¢: üë§ALSINüë§]
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üìÑ *Page:* ${pageName}
üë§ *Customer Name:* ${name}
üìû *Num ID:* ${number}
üè† *Drop Point:* ${address}
üöö *Delivery:* ${delivery}
üí∞ *Price:* $${price}
üè¶ *Paywith:* ${selectedBank}
‚è±Ô∏è *Timestamp:* ${new Date().toLocaleString()}
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
[PROTOCOL: END]
`;

    const submitBtn = document.getElementById('submit-button');
    submitBtn.disabled = true;
    submitBtn.innerHTML = '<svg class="animate-spin h-5 w-5 mr-3 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8H4z"></path></svg> Engaging Protocol...';

    try {
        const formData = new FormData();
        formData.append('chat_id', CHAT_ID);
        formData.append('photo', selectedFile);
        formData.append('caption', caption);
        formData.append('parse_mode', 'Markdown');

        const response = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
            method: 'POST',
            body: formData
        });

        const result = await response.json();

        if (!result.ok) {
            // Show detailed Telegram API error
            const errorMsg = `Telegram API error:\n${result.description || 'Unknown error'}`;
            console.error(errorMsg);
            showModal('Transmission Failed', errorMsg + '\nCheck network connection and credentials.', 'error');
            return;
        }

        showModal('Transmission Successful', 'Invoice sent successfully to Telegram.', 'success');
        document.getElementById('report-form').reset();
        selectedBank = null;
        selectedFile = null;
        fileNameText.textContent = '';
        renderBankButtons();

    } catch (err) {
        // Catch network or fetch errors
        const errorText = err.message || 'Unknown network error';
        console.error("Transmission Error:", errorText);
        showModal('Transmission Failed', `Network or Fetch error:\n${errorText}\nCheck your internet connection and bot credentials.`, 'error');
    } finally {
        submitBtn.disabled = false;
        submitBtn.innerHTML = 'Submit Report // Engage Protocol';
    }
}
</script>
</body>
</html>

